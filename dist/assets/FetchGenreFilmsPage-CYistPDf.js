import{o as x,s as e,a as l,n as g,M as f,v as j,r as m,j as n,L as w,b as _,u as v}from"./index-C1dRWSdc.js";x({id:g(),title:e(),originalTitle:e(),language:e(),releaseYear:g(),releaseDate:e(),genres:l(e()),plot:e().nullable(),runtime:g(),budget:e().nullable(),revenue:e().nullable(),homepage:e().nullable(),status:e(),posterUrl:e().nullable(),backdropUrl:e().nullable(),trailerUrl:e().nullable(),trailerYouTubeId:e().nullable(),tmdbRating:g().nullable(),searchL:e(),keywords:l(e()),countriesOfOrigin:l(e()),languages:l(e()),cast:l(e()),director:e().nullable(),production:e().nullable(),awardsSummary:e().nullable()});const N=l(f);function L(s){return fetch(`https://cinemaguide.skillbox.cc/movie?genre=${s}`).then(j).then(r=>r.json()).then(r=>{try{return N.parse(r)}catch(i){throw console.error("Ошибка валидации данных:",i),new Error(`Ошибка валидации данных для жанра ${s}`)}}).catch(r=>{throw console.error(`Ошибка при загрузке фильмов жанра ${s}:`,r),r})}const M=s=>m.createElement("svg",{width:13,height:22,viewBox:"0 0 13 22",fill:"none",xmlns:"http://www.w3.org/2000/svg",...s},m.createElement("path",{d:"M4.714 10.6066L12.9637 18.8561L10.6067 21.2131L0 10.6066L10.6067 0L12.9637 2.35702L4.714 10.6066Z",fill:"white"}));function P({moviesQuery:s,genreSlug:r,formatGenreTitle:i,pagination:o,onShowMore:a,isViewBtn:d}){return console.log(s.data),n.jsx("section",{className:"genre-films",children:n.jsxs("div",{className:"container",children:[n.jsxs("div",{className:"genre-films__wrapper",children:[n.jsx(M,{className:"genre-films__svg"}),n.jsx("h1",{className:"genre-films__title",children:i(r)})]}),s.isPending&&n.jsx("div",{className:"genres-loading",children:n.jsx("span",{children:"Загрузка фильмов..."})}),s.isError&&n.jsxs("div",{className:"genres-error",children:[n.jsx("span",{children:"Не удалось загрузить фильмы"}),n.jsx("button",{onClick:()=>s.refetch(),children:"Повторить запрос"})]}),s.isSuccess&&s.data.length===0&&n.jsx("div",{className:"no-movies",children:n.jsx("p",{children:"К сожалению, фильмов в этом жанре не найдено"})}),s.isSuccess&&o.length>0&&n.jsx("ul",{className:"genre-films__list",children:o.map(t=>n.jsx("li",{className:"genre-films__item",children:n.jsx(w,{to:`/movie/${t.id}`,className:"genre-films__link",children:n.jsx("img",{src:t.posterUrl??"/images/u.jpg",alt:t.title,className:"genre-films__image",loading:"lazy"})})},t.id))}),d&&n.jsx("button",{type:"button",className:"genre-films__btn",onClick:a,children:"Показать еще"})]})})}function k(){const{genreSlug:s}=_(),[r,i]=m.useState(1),o=15,a=v({queryFn:()=>{if(!s)throw new Error("Genre slug is required");return L(s)},queryKey:["moviesByGenre",s],enabled:!!s}),d=m.useMemo(()=>a.data?[...a.data].sort((u,b)=>(b.tmdbRating||0)-(u.tmdbRating||0)).slice(0,r*o):[],[a.data,r]),t=()=>{i(c=>c+1)},h=a.status==="success"&&a.data?.length>0&&d.length<a.data.length,p=c=>c?c.split("-").map(u=>u.charAt(0).toUpperCase()+u.slice(1)).join(" "):"";return n.jsx(P,{moviesQuery:a,genreSlug:s,formatGenreTitle:p,pagination:d,isViewBtn:h,onShowMore:t})}export{k as default};
